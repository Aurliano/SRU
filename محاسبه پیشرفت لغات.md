


    def get_avg_vocab_score(self, user_id, level):
        """Get the average score of vocabulary practice for a user and level."""
        try:
            self.cursor.execute(
                "SELECT AVG(score) FROM vocabulary v JOIN vocabulary_words w ON v.word = w.word WHERE v.user_id = ? AND w.level = ?",
                (user_id, level)
            )
            result = self.cursor.fetchone()
            return result[0] if result and result[0] is not None else 0
        except Exception as e:
            print(f"Error getting average vocabulary score: {e}")
            return 0


[7 tools called]

گام دوم با موفقیت انجام شد:

- یک متد جدید به user_db.py اضافه شد تا میانگین نمره تمرین لغت برای هر کاربر و سطح را محاسبه کند.
- در bot.py، محاسبه پیشرفت واژگان به صورت وزنی انجام شد: ۶۰٪ بر اساس نسبت لغات تمرین‌شده به کل لغات سطح و ۴۰٪ بر اساس میانگین نمره تمرین و آزمون لغت.
- این مقدار بعد از هر تمرین لغت و بعد از هر آزمون لغت در پیشرفت کاربر ذخیره می‌شود.
- هیچ خطای جدیدی در کد وجود ندارد.

اکنون پیشرفت واژگان کاربر دقیق‌تر و عادلانه‌تر محاسبه می‌شود.

آیا می‌خواهید سراغ گام بعدی (برگزاری خودکار آزمون بعد از هر ۲۰ لغت و ثبت نتیجه در پیشرفت) برویم؟